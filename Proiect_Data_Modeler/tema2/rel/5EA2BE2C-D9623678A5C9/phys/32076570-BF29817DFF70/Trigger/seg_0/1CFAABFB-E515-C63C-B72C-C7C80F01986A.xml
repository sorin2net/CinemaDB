<?xml version = '1.0' encoding = 'UTF-8'?>
<TriggerOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.TriggerOraclev10g" name="verifica_durata_film" directorySegmentName="seg_0" id="1CFAABFB-E515-C63C-B72C-C7C80F01986A">
<createdBy>Denis</createdBy>
<createdTime>2025-11-10 10:32:57 UTC</createdTime>
<ownerDesignName>tema2</ownerDesignName>
<actions>INSERT, UPDATE</actions>
<body><![CDATA[DECLARE
    v_durata NUMBER;
    v_ora_inceput DATE;
    v_ora_sfarsit_calc DATE;
BEGIN
    SELECT Durata INTO v_durata FROM Film WHERE id_film = :NEW.id_film;

    v_ora_inceput := TO_DATE(:NEW.ora_inceput, 'HH24:MI');
    v_ora_sfarsit_calc := v_ora_inceput + (v_durata/1440);  

    IF v_ora_sfarsit_calc > TO_DATE(:NEW.ora_sfarsit,'HH24:MI') THEN
        RAISE_APPLICATION_ERROR(-20003, 'Durata filmului depaseste intervalul orar selectat.');
    END IF;
END; ]]></body>
<triggerTime>BEFORE</triggerTime>
<state>ENABLE</state>
<table>E6E7D25A-E887-83B8-7C24-926CF7EE7AA1</table>
</TriggerOraclev10g>